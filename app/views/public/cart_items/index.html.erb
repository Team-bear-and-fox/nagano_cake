<div class="container">
  <div class="row">
    <div class="col">
      <h1>ショッピングカート</h1>
    <%=link_to "カートを空にする",destroy_all_cart_items_path, method: :delete, class:"btn btn-danger" %>
      <table class="table">
        <thead>
          <tr>
            <th>商品名</th>
            <th>単価(税込)</th>
            <th>数量</th>
            <th>小計</th>
            <th></th>
          </tr>
        </thead>
        <% @cart_items.each do |cart_item| %>
          <%= form_with model: cart_item, url: cart_item_path(cart_item.id) , method: :patch do |f| %>
          <tbody>
            <tr>
              <td><%= image_tag cart_item.item.get_image, :size =>'50x50' %><%= cart_item.item.name %></td>
              <td><%= cart_item.item.add_tax_value.to_s(:delimited) %></td>
              <td><%= f.select :amount, options_for_select((1..20).to_a, cart_item.amount), { id: 'amount' } %><%= f.submit"変更", class:"btn btn-success ml-5" %></td>
              <td><%= cart_item.add_sub_total %></td>
              <td><%=link_to "削除する", cart_item_path(cart_item.id), method: :delete, class:"btn btn-danger" %></td>
            </tr>
          </tbody>
          <% end %>
        <% end %>
        </table>
        <table class="table">
          <thead>
            <tr>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td><%="合計金額"%></td>
              <td>¥<%= @total.round.to_s(:delimited)%></td>
            </tr>
          </tbody>
        </table>
      <%=link_to "買い物を続ける", root_path, class:"btn btn-primary" %>
      <%=link_to "情報入力に進む", new_order_path, class:"btn btn-success" %>
    </div>
  </div>
</div>

